trigger:
- main

pool:
  name: Default  # Self-hosted Agent ã®åå‰

steps:
- checkout: self

# ğŸ”½ Dump CI Context æƒ…å ±ã‚’è¡¨ç¤ºï¼ˆFunction ã‹ã‚‰ã®å®Ÿè¡Œç¢ºèªç”¨ï¼‰
- script: |
    echo "Build.SourceBranch: $(Build.SourceBranch)"
    echo "Build.Reason: $(Build.Reason)"
    echo "Build.RequestedFor: $(Build.RequestedFor)"
    echo "Build.RequestedForEmail: $(Build.RequestedForEmail)"
    echo "Build.TriggeredByBuildId: $(Build.TriggeredByBuildId)"
    echo "Agent.Name: $(Agent.Name)"
    echo "Agent.OS: $(Agent.OS)"
    echo "Agent.MachineName: $(Agent.MachineName)"
    echo "System.TeamProject: $(System.TeamProject)"
    echo "System.CollectionUri: $(System.CollectionUri)"
  displayName: 'ğŸ” Show Pipeline Context'

# ğŸ”½ Terraform å®Ÿè¡Œã‚¹ãƒ†ãƒƒãƒ—
- script: |
    cd terraform
    terraform init
    terraform plan
    terraform apply -auto-approve
  displayName: 'Run Terraform'

  